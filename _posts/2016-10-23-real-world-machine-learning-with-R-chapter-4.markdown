--- 
layout: post
title:  "R code to accompany Real-World Machine Learning (Chapter 4)" 
date:   2016-10-23 03:30:00
comments: true
categories: 
- R
- ggplot2
- dplyr
- caret
- ROCR
- doMC
tags:
- R
- ggplot2
- dplyr
- caret
- ROCR
- doMC

abstract: In the latest update to the rwml-R Github repo, I provide R code to 
  accompany Chapter 4 of the book "Real-World Machine Learning" by 
  Henrik Brink, Joseph W. Richards, and Mark Fetherolf. Topics covered include 
  optimization of model parameters via grid search with `caret`, plotting a
  confusion matrix with `ggplot2`, and generating ROC curves with `ROCR`. This
  blog post provides a summary and some examples of the code contained
  in the update.
---

## Abstract

{{ page.abstract }}

## rwml-R project pages posted

For convenience, I've created a [project page for rwml-R][rwml-R] to post 
the generated HTML files 
from `knitr`. This (and [Chapter 2][chap2] and [Chapter 3][chap3]) blog posts 
are short 
summaries of the R code provided in the [rwml-R][rwml-R] project.
Also, feel free to [fork the rwml-R repo][rwml-R-fork]
and submit a pull request if you wish to contribute.

## Plotting a confusion matrix 

The MNIST dataset of handwritten digits makes another appearance.
The `kknn` package is again used, and the confusion matrix is plotted
using `ggplot2`. The color scale for the plot is generated using
the `RColorBrewer` package.

{% gist 42044ba43a115b5f606835740122acb4 %} 

![Figure generated by above code](
{{ "/assets/figure4_19.png" | prepend: site.baseurl | prepend: site.url }}) 

## Plotting a series of ROC curves 

The `ROCR` package is introduced and used to generate ROC curves. 
Also, AUC values are calculated for each curve and displayed along with 
each of the curves.

{% gist 7d04c669f38b0bd6caa21fa0eeb2d035 %}

![Figure generated by above code](
{{ "/assets/figure4_20.png" | prepend: site.baseurl | prepend: site.url }}) 

## Tuning model parameters

The [`caret`][caret] package is used to tune parameters via grid search
for the Support Vector Machines model with a Radial Basis Function Kernel. 
By setting `summaryFunction = twoClassSummary`
in `trainControl`, the `ROC` curve is used to select the optimal 
model. The [`doMC`][doMC] package is also introduced for parallel computation. 

## Feedback welcome 
If you have any feedback on the [rwml-R][rwml-R] project, please
leave a comment below or use the Tweet button.
Again, feel free to [fork the rwml-R repo][rwml-R-fork]
and submit a pull request if you wish to contribute.

<a class="github-button" href="https://github.com/padamson/rwml-R/archive/master.zip" data-icon="octicon-cloud-download" data-style="mega" aria-label="Download padamson/rwml-R on GitHub">Download</a>
<a class="github-button" href="https://github.com/padamson/rwml-R/fork" data-icon="octicon-repo-forked" data-style="mega" data-count-href="/padamson/rwml-R/network" data-count-api="/repos/padamson/rwml-R#forks_count" data-count-aria-label="# forks on GitHub" aria-label="Fork padamson/rwml-R on GitHub">Fork</a>

[caret]:        http://topepo.github.io/caret/
[rwml-R]:       https://padamson.github.io/rwml-R/
[rwml-R-fork]:  https://github.com/padamson/rwml-R/fork
[doMC]:         https://cran.r-project.org/web/packages/doMC/index.html
[chap2]:        http://padamson.github.io/r/machine%20learning/ggplot2/dplyr/tidyr/2016/10/01/real-world-machine-learning-with-R-intro.html
[chap3]:        http://padamson.github.io/r/ggplot2/dplyr/caret/2016/10/15/real-world-machine-learning-with-R-chapter-3.html
